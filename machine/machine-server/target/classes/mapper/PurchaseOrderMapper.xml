<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.server.mapper.PurchaseOrderMapper">

  <!-- 通用查询映射结果 -->
  <resultMap id="BaseResultMap" type="com.example.server.pojo.PurchaseOrder">
    <id column="id" property="id"/>
    <result column="number" property="number"/>
    <result column="imei" property="imei"/>
    <result column="category_id" property="categoryId"/>
    <result column="type" property="type"/>
    <result column="sku" property="sku"/>
    <result column="brand_id" property="brandId"/>
    <result column="rank" property="rank"/>
    <result column="stock_location" property="stockLocation"/>
    <result column="purchasing_channel_id" property="purchasingChannelId"/>
    <result column="enter_batch" property="enterBatch"/>
    <result column="purchase_price" property="purchasePrice"/>
    <result column="bidding_date" property="biddingDate"/>
    <result column="operated_ids" property="operatedIds"/>
    <result column="operating_id" property="operatingId"/>
    <result column="describe" property="describe"/>
  </resultMap>

  <!-- 通用查询结果列 -->
  <sql id="Base_Column_List">
    id, number, imei, category_id, type, brand_id, sku, rank, stock_location, purchasing_channel_id, enter_batch, purchase_price, bidding_date, operated_ids, operating_id,
    describe
  </sql>

  <!-- 分页获取采购单中的机器数据-->
  <select id="getMachineByPage" resultType="com.example.server.pojo.PurchaseOrder">
    select a.* from t_purchase_order as a
    where 1 = 1
    <if test="purchaseOrder.number != null and purchaseOrder.number != ''">
      and a.number like concat('%', #{purchaseOrder.number}, '%')
    </if>
    <if test="purchaseOrder.imei != null and purchaseOrder.imei != ''">
      and a.imei like concat('%', #{purchaseOrder.imei}, '%')
    </if>
    <if test="purchaseOrder.categoryId != null and purchaseOrder.categoryId != ''">
      and a.category_id = #{purchaseOrder.categoryId}
    </if>
    <if test="purchaseOrder.type != null and purchaseOrder.type != ''">
      and a.type like concat('%', #{purchaseOrder.type}, '%')
    </if>
    <if test="purchaseOrder.brandId != null and purchaseOrder.brandId != ''">
      and a.brand_id = #{purchaseOrder.brandId}
    </if>
    <if test="purchaseOrder.sku != null and purchaseOrder.sku != ''">
      and a.sku like concat('%', #{purchaseOrder.sku}, '%')
    </if>
    <if test="purchaseOrder.rank != null and purchaseOrder.rank != ''">
      and a.rank like concat('%', #{purchaseOrder.rank}, '%')
    </if>
    <if test="purchaseOrder.purchasingChannelId != null and purchaseOrder.purchasingChannelId != ''">
      and a.purchasing_channel_id = #{purchaseOrder.purchasingChannelId}
    </if>
    <if test="purchaseOrder.stockLocation != null and purchaseOrder.stockLocation != ''">
      and a.stock_location = #{purchaseOrder.purchasingChannelId}
    </if>
    <if test="purchaseOrder.enterBatch != null and purchaseOrder.enterBatch != ''">
      and a.enter_batch = #{purchaseOrder.enterBatch}
    </if>
    <if test="purchaseOrder.enterBatch != null and purchaseOrder.enterBatch != ''">
      and a.enter_batch = #{purchaseOrder.enterBatch}
    </if>
    <if test="purchaseOrder.operatingId != null and purchaseOrder.operatingId != ''">
      and a.operating_id = #{purchaseOrder.operatingId}
    </if>
    <if test="bidDateScope != null and bidDateScope.length == 2">
      and a.bidding_date between #{bidDateScope[0]} and #{bidDateScope[1]}
    </if>
  </select>

</mapper>
