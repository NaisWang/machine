<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.server.mapper.UrlMapper">

  <!-- 通用查询映射结果 -->
  <resultMap id="BaseResultMap" type="com.example.server.pojo.Url">
    <id column="id" property="id"/>
    <result column="url" property="url"/>
  </resultMap>

  <resultMap id="UrlWithRole" type="com.example.server.pojo.Url" extends="BaseResultMap">
    <collection property="roleName" ofType="java.lang.String">
      <constructor>
        <arg column="name"/>
      </constructor>
    </collection>
  </resultMap>

  <!-- 通用查询结果列 -->
  <sql id="Base_Column_List">
    id, url
  </sql>

  <!--获取所有Url以及对应的角色英文名-->
  <select id="getUrlsWithRole" resultMap="UrlWithRole">
    select c.id      id,
           c.url     url,
           a.en_name name
    from t_role as a
           left join t_role_url_method as b on a.id = b.role_id
           left join t_url as c on c.id = b.url_id
  </select>

</mapper>
